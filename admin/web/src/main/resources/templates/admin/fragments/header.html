<!DOCTYPE html>
<div
        th:fragment="header(appName)"
        xmlns:th="http://www.thymeleaf.org"
        xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
        class="border-b border-border bg-surface"
>
    <wm-confirm-dialog
            th:attr="title-text=#{admin.confirm.title},confirm-text=#{admin.confirm.confirm},cancel-text=#{admin.confirm.cancel}">
    </wm-confirm-dialog>
    <div class="container-page flex items-center justify-between py-4 h-16">
        <a class="text-xl font-semibold no-underline text-black items-center flex gap-x-1 hover:!text-black"
           th:href="@{/admin}">
            <img th:src="@{/assets/shared/icons/outline/wifi.svg}" alt="Logo" class="inline w-8 h-8">
            <span th:text="${appName}">WiFi Manager</span>
        </a>

        <div sec:authorize="isAuthenticated()" class="relative group">
            <button
                    type="button"
                    class="flex items-center gap-3 rounded-lg px-3 py-2 transition hover:bg-surface-muted focus:outline-none focus:ring-2 focus:ring-brand-500"
                    aria-haspopup="menu"
                    aria-label="User menu"
            >
                <img
                        th:if="${currentUser != null and currentUser.pictureUrl != null and !#strings.isEmpty(currentUser.pictureUrl)}"
                        th:src="${currentUser.pictureUrl}"
                        alt="Profile picture"
                        class="h-9 w-9 rounded-full border border-border object-cover"
                        referrerpolicy="no-referrer"
                />

                <span
                        class="text-sm font-medium"
                        th:text="${currentUser != null ? currentUser.displayName : #authentication.name}"
                >User</span
                >

                <svg
                        class="h-4 w-4 text-text-muted"
                        viewBox="0 0 20 20"
                        fill="currentColor"
                        aria-hidden="true"
                >
                    <path
                            fill-rule="evenodd"
                            d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.94l3.71-3.71a.75.75 0 1 1 1.06 1.06l-4.24 4.25a.75.75 0 0 1-1.06 0L5.21 8.29a.75.75 0 0 1 .02-1.08Z"
                            clip-rule="evenodd"
                    />
                </svg>
            </button>

            <div
                    role="menu"
                    class="absolute right-0 z-20 mt-0 hidden w-56 overflow-hidden rounded-xl border border-border bg-surface pt-2 shadow-lg group-hover:block group-focus-within:block"
            >
                <div class="px-4 py-3">
                    <div class="text-sm font-semibold" th:text="#{admin.account.title}">Account</div>
                    <div
                            class="text-xs text-text-muted"
                            th:text="${currentUser != null ? currentUser.email : ''}"
                    ></div>
                </div>

                <div class="border-t border-border"></div>

                <a class="block px-4 py-2 text-sm hover:bg-surface-muted" href="#" role="menuitem"
                   th:text="#{admin.account.settings}">Settings</a>
                <a class="block px-4 py-2 text-sm hover:bg-surface-muted" href="#" role="menuitem"
                   th:text="#{admin.account.help}">Help</a>

                <div class="border-t border-border"></div>

                <div class="px-4 pb-1 pt-2 text-xs font-semibold uppercase tracking-wide text-text-muted"
                     th:text="#{admin.language.label}">
                    Language
                </div>
                <a class="flex items-center gap-2 px-4 py-2 text-sm hover:bg-surface-muted"
                   th:classappend="${#locale.language == 'en'} ? ' font-semibold text-brand-600' : ''"
                   href="?lang=en"
                   role="menuitem">
                    <img
                            th:src="@{/assets/shared/flags/gb.svg}"
                            alt=""
                            class="h-4 w-4 rounded-sm"
                    />
                    <span th:text="#{admin.language.en}">English</span>
                </a>
                <a class="flex items-center gap-2 px-4 py-2 text-sm hover:bg-surface-muted"
                   th:classappend="${#locale.language == 'cs'} ? ' font-semibold text-brand-600' : ''"
                   href="?lang=cs"
                   role="menuitem">
                    <img
                            th:src="@{/assets/shared/flags/cz.svg}"
                            alt=""
                            class="h-4 w-4 rounded-sm"
                    />
                    <span th:text="#{admin.language.cs}">Czech</span>
                </a>

                <div class="border-t border-border"></div>

                <form th:action="@{/admin/logout}" method="post" class="p-2">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <button class="btn btn-secondary w-full" type="submit" role="menuitem"
                            th:text="#{admin.account.logout}">Logout</button>
                </form>
            </div>
        </div>
    </div>
</div>
