@tailwind base;
@tailwind components;
@tailwind utilities;


@layer base {
  :root {
    --brand-50: 239 246 255;
    --brand-100: 219 234 254;
    --brand-500: 59 130 246;
    --brand-600: 37 99 235;
    --brand-700: 29 78 216;

    --surface: 255 255 255;
    --surface-muted: 248 250 252;
    --text: 15 23 42;
    --text-muted: 71 85 105;
    --border: 226 232 240;

    --danger: 220 38 38;
    --success: 22 163 74;
    --warning: 234 179 8;
  }

  html {
    @apply text-text bg-surface text-base;
  }

  body {
    @apply min-h-screen antialiased;
  }

  a {
    @apply text-brand-700 hover:text-brand-600 underline underline-offset-4;
  }
}

@layer components {
  .container-page {
    @apply mx-auto w-full max-w-5xl px-4 py-6;
  }

  .card {
    @apply rounded-2xl border border-border bg-surface p-6 shadow-sm;
  }

  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2 text-base font-medium transition;
    @apply border border-transparent focus:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .btn-primary {
    @apply bg-brand-600 text-white hover:bg-brand-700;
  }

  .btn-secondary {
    @apply bg-surface-muted text-text border-border hover:bg-surface;
  }

  .btn-danger {
    @apply bg-danger text-white hover:opacity-90;
  }

  .input {
    @apply w-full rounded-xl border border-border bg-surface px-3 py-2 text-base;
    @apply placeholder:text-text-muted focus:outline-none focus:ring-2 focus:ring-brand-500;
  }

  .select {
    @apply input pr-9;
  }

  .textarea {
    @apply input min-h-24;
  }

  .checkbox {
    @apply h-5 w-5 rounded border border-border text-brand-600;
    @apply focus:outline-none focus:ring-2 focus:ring-brand-500;
  }

  .checkbox-label {
    @apply flex items-center gap-3 text-sm;
  }

  .checkbox-label .checkbox {
    @apply mt-0.5;
  }

  .label {
    @apply mb-1 block text-base font-medium text-text;
  }

  .help {
    @apply mt-1 text-xs text-text-muted;
  }

  .badge {
    @apply inline-flex items-center rounded-full bg-surface-muted px-2 py-0.5 text-xs font-medium text-text;
  }

  .alert {
    @apply rounded-2xl border border-border bg-surface-muted p-4 text-base;
  }

  .alert-success {
    @apply border-success/30 bg-success/10 text-success;
  }

  .alert-warning {
    @apply border-warning/30 bg-warning/10 text-text;
  }

  .alert-danger {
    @apply border-danger/30 bg-danger/10 text-danger;
  }

  .table {
    @apply w-full border-collapse text-base;
  }

  .table th {
    @apply border-b border-border bg-surface-muted px-3 py-2 text-left font-medium text-text;
  }

  .table td {
    @apply border-b border-border px-3 py-2 text-text;
  }

  .table tr:hover td {
    @apply bg-surface-muted;
  }

  .tooltip {
    @apply relative;
  }

  .tooltip[data-tooltip] {
    @apply underline decoration-dashed underline-offset-4 decoration-1;
  }

  .tooltip[data-tooltip]::after {
    content: attr(data-tooltip);
    @apply pointer-events-none absolute left-1/2 bottom-full mb-1.5 -translate-x-1/2 translate-y-0.5 opacity-0;
    @apply z-50 max-w-sm whitespace-nowrap rounded-lg px-2.5 py-1.5 text-sm leading-tight shadow-lg;
    @apply bg-[rgb(var(--text))] text-[rgb(var(--surface))];
    @apply transition-transform duration-150 ease-out;
  }

  .tooltip[data-tooltip]::before {
    content: "";
    @apply pointer-events-none absolute left-1/2 bottom-full mb-0.5 -translate-x-1/2 translate-y-0.5 opacity-0;
    @apply z-40 border-[0.4rem] border-transparent border-t-[rgb(var(--text))];
    @apply transition-transform duration-150 ease-out;
  }

  .tooltip[data-tooltip]:hover::after,
  .tooltip[data-tooltip]:focus-visible::after,
  .tooltip[data-tooltip]:hover::before,
  .tooltip[data-tooltip]:focus-visible::before {
    @apply translate-y-0 opacity-100;
  }
}

/* Form submit spinner */

button:has(.spinner) {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  transition: all 0.2s ease;
}

button .spinner {
  width: 1.2em;
  height: 1.2em;
  border: 2px solid transparent; /* light gray background */
  border-top: 2px solid rgba(0, 0, 0, 0.35); /* visible arc */
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
  transition: all 0.2s ease;
  opacity: 0; /* Hide spinner by default */
  display: none;
}

/* Show spinner when form is in-flight */
form.htmx-request button .spinner, button.htmx-request .spinner {
  opacity: 1;
  display: inline-block;
}

/* Optional: fade text while loading */
form.htmx-request button .btn-text, button.htmx-request .btn-text {
  opacity: 0.6;
}

/* Prevent double clicks */
form.htmx-request button, button.htmx-request:has(.spinner) {
  pointer-events: none;
  opacity: 0.8;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/*Hide Quagga elements*/

canvas.drawingBuffer {
  display: block;
  position: absolute;
  z-index: 2;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

canvas.drawingBuffer + br {
  display: none;
}
